(function(e,h,i,b){var g="RRZERateButton",a=e(h),c=e(i),d={ID:0,nonce:"",rateStatus:0,counterSelector:".count-box",containerSelector:".rrze-rate-container",buttonSelector:".rrze-rate-btn"},f={"rrze-rate-id":"ID","rrze-rate-nonce":"nonce","rrze-rate-status":"rateStatus"};function j(m,k){this.element=m;this.$element=e(m);this.settings=e.extend({},d,k);this._defaults=d;this._name=g;this.buttonElement=this.$element.find(this.settings.buttonSelector);this.containerElement=this.$element.find(this.settings.containerSelector);this.counterElement=this.containerElement.find(this.settings.counterSelector);for(var l in f){var n=this.buttonElement.data(l);if(n!==b){this.settings[f[l]]=n}}this.init()}e.extend(j.prototype,{init:function(){this.buttonElement.click(this.initRate.bind(this))},ajax:function(k,l){e.ajax({url:rrze_rate_params.ajax_url,type:"POST",cache:false,dataType:"json",data:k}).done(l)},initRate:function(k){k.stopPropagation();this.updateAllButtons();this.buttonElement.prop("disabled",true);this.containerElement.addClass("rrze-rate-is-loading");this.ajax({action:"rrze_rate_process",id:this.settings.ID,nonce:this.settings.nonce,status:this.settings.rateStatus},function(l){this.containerElement.removeClass("rrze-rate-is-loading");if(l.success){this.updateMarkup(l)}this.buttonElement.prop("disabled",false)}.bind(this))},updateMarkup:function(k){switch(this.settings.rateStatus){case 1:this.buttonElement.attr("data-rrze-rate-status",2);this.settings.rateStatus=2;this.containerElement.addClass("rrze-rate-is-rated").removeClass("rrze-rate-is-not-rated");this.containerElement.children().first().addClass("rrze-rate-click-is-disabled");this.counterElement.text(k.data.content);break;case 2:this.containerElement.children().first().addClass("rrze-rate-click-is-disabled");break}},updateAllButtons:function(){this.allButtons=c.find(".rrze-rate-btn-"+this.settings.ID);if(this.allButtons.length>1){this.buttonElement=this.allButtons;this.containerElement=this.buttonElement.closest(this.settings.containerSelector);this.counterElement=this.containerElement.find(this.settings.counterSelector)}},});e.fn[g]=function(k){return this.each(function(){if(!e.data(this,"plugin_"+g)){e.data(this,"plugin_"+g,new j(this,k))}})}})(jQuery,window,document);(function(a){a(function(){a(this).bind("DOMNodeInserted",function(b){a(".rrze-rate-wrap").RRZERateButton()})});a(".rrze-rate-wrap").RRZERateButton()})(jQuery);